<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Regression | Introduction to Statistics</title>
  <meta name="description" content="Chapter 7 Regression | Introduction to Statistics" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Regression | Introduction to Statistics" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Regression | Introduction to Statistics" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="seminar6.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="lib/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="js/codefolding.js"></script>


<script>
$(document).ready(function () {
  window.initializeCodeFolding();
});
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="lib\bootstrap\3.3.7\css\bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="css\readthedocs.css" type="text/css" />
<link rel="stylesheet" href="css\custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this course</a></li>
<li class="chapter" data-level="1" data-path="seminar1.html"><a href="seminar1.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="seminar1.html"><a href="seminar1.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a><ul>
<li class="chapter" data-level="1.1.1" data-path="seminar1.html"><a href="seminar1.html#what-is-r"><i class="fa fa-check"></i><b>1.1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.1.2" data-path="seminar1.html"><a href="seminar1.html#rstudio"><i class="fa fa-check"></i><b>1.1.2</b> RStudio</a></li>
<li class="chapter" data-level="1.1.3" data-path="seminar1.html"><a href="seminar1.html#console"><i class="fa fa-check"></i><b>1.1.3</b> Console</a></li>
<li class="chapter" data-level="1.1.4" data-path="seminar1.html"><a href="seminar1.html#scripts"><i class="fa fa-check"></i><b>1.1.4</b> Scripts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="seminar2.html"><a href="seminar2.html"><i class="fa fa-check"></i><b>2</b> Data Stuctures and Data Types</a><ul>
<li class="chapter" data-level="2.1" data-path="seminar2.html"><a href="seminar2.html#seminar"><i class="fa fa-check"></i><b>2.1</b> Seminar</a><ul>
<li class="chapter" data-level="2.1.1" data-path="seminar2.html"><a href="seminar2.html#functions"><i class="fa fa-check"></i><b>2.1.1</b> Functions</a></li>
<li class="chapter" data-level="2.1.2" data-path="seminar2.html"><a href="seminar2.html#getting-help"><i class="fa fa-check"></i><b>2.1.2</b> Getting Help</a></li>
<li class="chapter" data-level="2.1.3" data-path="seminar2.html"><a href="seminar2.html#the-assignment-operator"><i class="fa fa-check"></i><b>2.1.3</b> The Assignment Operator</a></li>
<li class="chapter" data-level="2.1.4" data-path="seminar2.html"><a href="seminar2.html#vectors-and-subsetting"><i class="fa fa-check"></i><b>2.1.4</b> Vectors and subsetting</a></li>
<li class="chapter" data-level="2.1.5" data-path="seminar2.html"><a href="seminar2.html#matrices"><i class="fa fa-check"></i><b>2.1.5</b> Matrices</a></li>
<li class="chapter" data-level="2.1.6" data-path="seminar2.html"><a href="seminar2.html#arrays"><i class="fa fa-check"></i><b>2.1.6</b> Arrays</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="seminar3.html"><a href="seminar3.html"><i class="fa fa-check"></i><b>3</b> Creating and Exploring Data Frames</a><ul>
<li class="chapter" data-level="3.1" data-path="seminar3.html"><a href="seminar3.html#seminar-1"><i class="fa fa-check"></i><b>3.1</b> Seminar</a><ul>
<li class="chapter" data-level="3.1.1" data-path="seminar3.html"><a href="seminar3.html#clearing-your-workspace-from-previous-work"><i class="fa fa-check"></i><b>3.1.1</b> Clearing your workspace from previous work</a></li>
<li class="chapter" data-level="3.1.2" data-path="seminar3.html"><a href="seminar3.html#creating-data-frames"><i class="fa fa-check"></i><b>3.1.2</b> Creating data frames</a></li>
<li class="chapter" data-level="3.1.3" data-path="seminar3.html"><a href="seminar3.html#working-with-data-frames"><i class="fa fa-check"></i><b>3.1.3</b> Working with data frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="seminar4.html"><a href="seminar4.html"><i class="fa fa-check"></i><b>4</b> Data Import (from csv, txt, and excel) and Saving Data Frames</a><ul>
<li class="chapter" data-level="4.1" data-path="seminar4.html"><a href="seminar4.html#seminar-2"><i class="fa fa-check"></i><b>4.1</b> Seminar</a><ul>
<li class="chapter" data-level="4.1.1" data-path="seminar4.html"><a href="seminar4.html#setting-up"><i class="fa fa-check"></i><b>4.1.1</b> Setting up</a></li>
<li class="chapter" data-level="4.1.2" data-path="seminar4.html"><a href="seminar4.html#loading-data"><i class="fa fa-check"></i><b>4.1.2</b> Loading data</a></li>
<li class="chapter" data-level="4.1.3" data-path="seminar4.html"><a href="seminar4.html#importing-a-dataset-in-.csv-format"><i class="fa fa-check"></i><b>4.1.3</b> Importing a dataset in <code>.csv</code> format</a></li>
<li class="chapter" data-level="4.1.4" data-path="seminar4.html"><a href="seminar4.html#importing-a-dataset-in-excel-xlsx-format"><i class="fa fa-check"></i><b>4.1.4</b> Importing a dataset in Excel (xlsx) format</a></li>
<li class="chapter" data-level="4.1.5" data-path="seminar4.html"><a href="seminar4.html#importing-a-dataset-in-rdata-format"><i class="fa fa-check"></i><b>4.1.5</b> Importing a dataset in RData format</a></li>
<li class="chapter" data-level="4.1.6" data-path="seminar4.html"><a href="seminar4.html#importing-a-dataset-in-.txt-format."><i class="fa fa-check"></i><b>4.1.6</b> Importing a dataset in .txt format.</a></li>
<li class="chapter" data-level="4.1.7" data-path="seminar4.html"><a href="seminar4.html#saving-data-frames"><i class="fa fa-check"></i><b>4.1.7</b> Saving data frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="seminar5.html"><a href="seminar5.html"><i class="fa fa-check"></i><b>5</b> Descriptive Statistics</a><ul>
<li class="chapter" data-level="5.1" data-path="seminar5.html"><a href="seminar5.html#seminar-3"><i class="fa fa-check"></i><b>5.1</b> Seminar</a><ul>
<li class="chapter" data-level="5.1.1" data-path="seminar5.html"><a href="seminar5.html#central-tendency"><i class="fa fa-check"></i><b>5.1.1</b> Central tendency</a></li>
<li class="chapter" data-level="5.1.2" data-path="seminar5.html"><a href="seminar5.html#dispersion"><i class="fa fa-check"></i><b>5.1.2</b> Dispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="seminar6.html"><a href="seminar6.html"><i class="fa fa-check"></i><b>6</b> Correlations and differences in means</a><ul>
<li class="chapter" data-level="6.1" data-path="seminar6.html"><a href="seminar6.html#seminar-4"><i class="fa fa-check"></i><b>6.1</b> Seminar</a><ul>
<li class="chapter" data-level="6.1.1" data-path="seminar6.html"><a href="seminar6.html#bivariate-relationships"><i class="fa fa-check"></i><b>6.1.1</b> Bivariate relationships</a></li>
<li class="chapter" data-level="6.1.2" data-path="seminar6.html"><a href="seminar6.html#hypothesis-testing"><i class="fa fa-check"></i><b>6.1.2</b> Hypothesis testing</a></li>
<li class="chapter" data-level="6.1.3" data-path="seminar6.html"><a href="seminar6.html#t-test-difference-in-means"><i class="fa fa-check"></i><b>6.1.3</b> T-test (difference in means)</a></li>
<li class="chapter" data-level="6.1.4" data-path="seminar6.html"><a href="seminar6.html#relationships-between-continuous-variables"><i class="fa fa-check"></i><b>6.1.4</b> Relationships between continuous variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="seminar9.html"><a href="seminar9.html"><i class="fa fa-check"></i><b>7</b> Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="seminar9.html"><a href="seminar9.html#seminar-5"><i class="fa fa-check"></i><b>7.1</b> Seminar</a><ul>
<li class="chapter" data-level="7.1.1" data-path="seminar9.html"><a href="seminar9.html#bivariate-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Bivariate linear regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="seminar9.html"><a href="seminar9.html#interpreting-regression-output"><i class="fa fa-check"></i><b>7.1.2</b> Interpreting Regression Output</a></li>
<li class="chapter" data-level="7.1.3" data-path="seminar9.html"><a href="seminar9.html#multivariate-linear-regression"><i class="fa fa-check"></i><b>7.1.3</b> Multivariate linear regression</a></li>
<li class="chapter" data-level="7.1.4" data-path="seminar9.html"><a href="seminar9.html#additional-resources"><i class="fa fa-check"></i><b>7.1.4</b> Additional Resources</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Regression</h1>
<div id="seminar-5" class="section level2">
<h2><span class="header-section-number">7.1</span> Seminar</h2>
<p>In this section, we will cover regression models. We will first introduce the bivariate linear regression model. We will then move to linear models with multiple independent variables.</p>
<div id="bivariate-linear-regression" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Bivariate linear regression</h3>
<p>We will use a dataset collected by the US census bureau that contains several socioeconomic indicators.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">communities &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;communities.csv&quot;</span>)</a></code></pre></div>
<p>The dataset includes 38 variables but we’re only interested in a handful at the moment.</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PctUnemployed</td>
<td align="left">proportion of citizens in each community who are unemployed</td>
</tr>
<tr class="even">
<td align="left">PctNotHSGrad</td>
<td align="left">proportion of citizens in each community who failed to finish high-school</td>
</tr>
<tr class="odd">
<td align="left">population</td>
<td align="left">proportion of adult population living in cities</td>
</tr>
</tbody>
</table>
<p>If we summarize these variables with the <code>summary()</code> function, we will see that they are both measured as proportions (they vary between 0 and 1):</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">summary</span>(communities<span class="op">$</span>PctUnemployed)</a></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.2200  0.3200  0.3635  0.4800  1.0000 </code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">summary</span>(communities<span class="op">$</span>PctNotHSGrad)</a></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.2300  0.3600  0.3833  0.5100  1.0000 </code></pre>
<p>It will be a little easier to interpret the regression output if we convert these to percentages rather than proportions. We can do this with the following lines of code:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1">communities<span class="op">$</span>PctUnemployed &lt;-<span class="st"> </span>communities<span class="op">$</span>PctUnemployed <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb132-2" title="2">communities<span class="op">$</span>PctNotHSGrad &lt;-<span class="st"> </span>communities<span class="op">$</span>PctNotHSGrad <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<p>We can begin by drawing a scatterplot with the percentage of unemployed people on the y-axis and the percentage of adults without high-school education on the x-axis.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb133-2" title="2">  <span class="dt">x =</span> communities<span class="op">$</span>PctNotHSGrad,</a>
<a class="sourceLine" id="cb133-3" title="3">  <span class="dt">y =</span> communities<span class="op">$</span>PctUnemployed,</a>
<a class="sourceLine" id="cb133-4" title="4">  <span class="dt">xlab =</span> <span class="st">&quot;Adults without high school education (%)&quot;</span>,</a>
<a class="sourceLine" id="cb133-5" title="5">  <span class="dt">ylab =</span> <span class="st">&quot;Unemployment (%)&quot;</span>,</a>
<a class="sourceLine" id="cb133-6" title="6">  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb133-7" title="7">  <span class="dt">pch =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb133-8" title="8">  <span class="dt">col =</span> <span class="st">&quot;LightSkyBlue&quot;</span></a>
<a class="sourceLine" id="cb133-9" title="9">)</a></code></pre></div>
<p><img src="stats101_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<p>From looking at the plot, what is the association between the unemployment rate and lack of high-school level education?</p>
<p>In order to answer that question empirically, we will run a linear regression using the <a href="http://bit.ly/R_lm"><code>lm()</code></a> function in R. The <a href="http://bit.ly/R_lm"><code>lm()</code></a> function needs to know a) the relationship we’re trying to model and b) the dataset for our observations. The two arguments we need to provide to the <a href="http://bit.ly/R_lm"><code>lm()</code></a> function are described below.</p>
<table>
<colgroup>
<col width="11%" />
<col width="88%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>formula</code></td>
<td>The <code>formula</code> describes the relationship between the dependent and independent variables, for example <code>dependent.variable ~ independent.variable</code> <br> In our case, we’d like to model the relationship using the formula: <code>PctUnemployed ~ PctNotHSGrad</code></td>
</tr>
<tr class="even">
<td><code>data</code></td>
<td>This is simply the name of the dataset that contains the variable of interest. In our case, this is the merged dataset called <code>communities</code>.</td>
</tr>
</tbody>
</table>
<p>For more information on how the <code>lm()</code> function works, type help(lm) in R.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1">model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(PctUnemployed <span class="op">~</span><span class="st"> </span>PctNotHSGrad, <span class="dt">data =</span> communities)</a></code></pre></div>
</div>
<div id="interpreting-regression-output" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Interpreting Regression Output</h3>
<p>The <a href="http://bit.ly/R_lm"><code>lm()</code></a> function has modeled the relationship between <code>PctUnemployed</code> and <code>PctNotHSGrad</code> and we’ve saved it in an object called <code>model1</code>. Let’s use the <a href="http://bit.ly/R_summary"><code>summary()</code></a> function to see what this linear model looks like.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="kw">summary</span>(model1)</a></code></pre></div>
<p>The output from <a href="http://bit.ly/R_summary"><code>summary()</code></a> might seem overwhelming at first so let’s break it down one item at a time.</p>
<p><img src="img/lm-annotated-1.png" width="700" /></p>
<table>
<colgroup>
<col width="7%" />
<col width="23%" />
<col width="69%" />
</colgroup>
<thead>
<tr class="header">
<th>#</th>
<th>Item</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>1</strong></td>
<td><em>formula</em></td>
<td>The <em>formula</em> describes the relationship between the dependent and independent variables</td>
</tr>
<tr class="even">
<td><strong>2</strong></td>
<td><em>residuals</em></td>
<td>The differences between the observed values and the predicted values are called <em>residuals</em>.</td>
</tr>
<tr class="odd">
<td><strong>3</strong></td>
<td><em>coefficients</em></td>
<td>The <em>coefficients</em> for all the <em>independent</em> variables and the intercept. Using the <em>coefficients</em> we can write down the relationship between the <em>dependent</em> and the <em>independent</em> variables as: <br><br><code>PctUnemployed</code> = 7.8952023 + ( 0.7423853 * <code>PctNotHSGrad</code> ) <br><br>This tells us that for each unit increase in the variable <code>PctNotHSGrad</code>, the <code>PctUnemployed</code> increases by 0.7423853.</td>
</tr>
<tr class="even">
<td><strong>4</strong></td>
<td><em>standard error</em></td>
<td>The <em>standard error</em> estimates the standard deviation of the sampling distribution of the coefficients in our model. We can think of the <em>standard error</em> as the measure of precision for the estimated coefficients.</td>
</tr>
<tr class="odd">
<td><strong>5</strong></td>
<td><em>t-statistic</em></td>
<td>The <em>t-statistic</em> is obtained by dividing the <em>coefficients</em> by the <em>standard error</em>.</td>
</tr>
<tr class="even">
<td><strong>6</strong></td>
<td><em>p-value</em></td>
<td>The <em>p-value</em> for each of the coefficients in the model. Recall that according to the null hypotheses, the value of the coefficient of interest is zero. The <em>p-value</em> tells us whether can can reject the null hypotheses or not.</td>
</tr>
<tr class="odd">
<td><strong>7</strong></td>
<td><span class="math inline">\(R^2\)</span> and <em>adj-<span class="math inline">\(R^2\)</span></em></td>
<td>tell us how much of the variance in our model is accounted for by the <em>independent</em> variable. The <em>adjusted <span class="math inline">\(R^2\)</span></em> is always smaller than <em><span class="math inline">\(R^2\)</span></em> as it takes into account the number of <em>independent</em> variables and degrees of freedom.</td>
</tr>
</tbody>
</table>
<p>Now let’s add a regression line to the scatter plot using the <a href="http://bit.ly/R_abline"><code>abline()</code></a> function.</p>
<p>First we run the same <a href="http://bit.ly/R_plot"><code>plot()</code></a> function as before, then we overlay a line with <a href="http://bit.ly/R_abline"><code>abline()</code></a>:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb136-2" title="2">  <span class="dt">x =</span> communities<span class="op">$</span>PctNotHSGrad,</a>
<a class="sourceLine" id="cb136-3" title="3">  <span class="dt">y =</span> communities<span class="op">$</span>PctUnemployed,</a>
<a class="sourceLine" id="cb136-4" title="4">  <span class="dt">xlab =</span> <span class="st">&quot;Adults without high school education (%)&quot;</span>,</a>
<a class="sourceLine" id="cb136-5" title="5">  <span class="dt">ylab =</span> <span class="st">&quot;Unemployment (%)&quot;</span>,</a>
<a class="sourceLine" id="cb136-6" title="6">  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb136-7" title="7">  <span class="dt">pch =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb136-8" title="8">  <span class="dt">col =</span> <span class="st">&quot;LightSkyBlue&quot;</span></a>
<a class="sourceLine" id="cb136-9" title="9">)</a>
<a class="sourceLine" id="cb136-10" title="10"></a>
<a class="sourceLine" id="cb136-11" title="11"><span class="kw">abline</span>(model1, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="stats101_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<p>We can see by looking at the regression line that it matches the coefficients we estimated above. For example, when <code>PctNotHSGrad</code> is equal to zero (i.e. where the line intersects the Y-axis), the predicted value for <code>PctUnemployed</code> seems to be above 0 but below 10. This is good, as the <em>intercept</em> coefficient we estimated in the regression was 7.8952023.</p>
<p>Similarly, the coefficient for the variable <code>PctNotHSGrad</code> was estimated to be 0.7423853, which implies that a one point increase in the percentage of citizens with no high-school education is associated with about 0.7423853 of a point increase in the percentage of citizens who are unemployed. The line in the plot seems to reflect this: it is upward sloping, so that higher levels of the no high-school variable are associated with higher levels of unemployment, but the relationship is not quite 1-to-1. That is, for each additional percentage point of citzens without high school education, the percentage of citizens who are unemployed increases by a little less than one point.</p>
</div>
<div id="multivariate-linear-regression" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Multivariate linear regression</h3>
<p>We might be interested in other variables that could explain the outcome. For instance, unemployment may be explained whether an community has a high urban population. For example, a more urban population may have better access to jobs.</p>
<p>Again we need to change the scale of a variable of interest - urban populationx, so that it is more interpretable.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">communities<span class="op">$</span>PctUrban &lt;-<span class="st"> </span>communities<span class="op">$</span>population <span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<p>Now lets add this to the model.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1">model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(PctUnemployed <span class="op">~</span><span class="st"> </span>PctNotHSGrad <span class="op">+</span><span class="st"> </span>PctUrban, <span class="dt">data =</span> communities)</a>
<a class="sourceLine" id="cb138-2" title="2"><span class="kw">summary</span>(model2)</a></code></pre></div>
<pre><code>
Call:
lm(formula = PctUnemployed ~ PctNotHSGrad + PctUrban, data = communities)

Residuals:
    Min      1Q  Median      3Q     Max 
-41.203  -8.372  -1.274   7.399  57.474 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   7.17377    0.64909  11.052  &lt; 2e-16 ***
PctNotHSGrad  0.73651    0.01480  49.748  &lt; 2e-16 ***
PctUrban      0.16436    0.02362   6.957 4.69e-12 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 13.36 on 1991 degrees of freedom
Multiple R-squared:  0.5636,    Adjusted R-squared:  0.5631 
F-statistic:  1286 on 2 and 1991 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The coefficient for urban population is positive, which suggests a higher urban population increases unemployment. A one unit change in population increases unemployment by 1.64%. Because this variable is at the same scale, we can compare this with the coefficient concerning the percentage of people without high school education. The p-value for this coefficient is also extremely low, meaning the estimate is statistically significant. Finally, we can see that the adjusted R-square has moved from 0.5527 to 0.5631 after adding the additional variable. This suggests the model is able to explain a bit more variation and has slightly more predictive power than the bivariate regression.</p>
<p>Let’s plot the regression line:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb140-2" title="2">  <span class="dt">x =</span> communities<span class="op">$</span>PctNotHSGrad,</a>
<a class="sourceLine" id="cb140-3" title="3">  <span class="dt">y =</span> communities<span class="op">$</span>PctUnemployed,</a>
<a class="sourceLine" id="cb140-4" title="4">  <span class="dt">xlab =</span> <span class="st">&quot;Adults without high school education (%)&quot;</span>,</a>
<a class="sourceLine" id="cb140-5" title="5">  <span class="dt">ylab =</span> <span class="st">&quot;Unemployment (%)&quot;</span>,</a>
<a class="sourceLine" id="cb140-6" title="6">  <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb140-7" title="7">  <span class="dt">pch =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb140-8" title="8">  <span class="dt">col =</span> <span class="st">&quot;LightSkyBlue&quot;</span></a>
<a class="sourceLine" id="cb140-9" title="9">)</a>
<a class="sourceLine" id="cb140-10" title="10"><span class="kw">abline</span>(model1, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="stats101_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<p>As you can see from the plot, there are strange observations at the top of the y-axis and x-axis. This is strange as no observations with no education are likely to have 100% employment. These outliers or incorrect values will bias the results, so lets run another model without these high values using subsetting:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">model3 &lt;-<span class="st"> </span><span class="kw">lm</span>(PctUnemployed <span class="op">~</span><span class="st"> </span>PctNotHSGrad <span class="op">+</span><span class="st"> </span>PctUrban, </a>
<a class="sourceLine" id="cb141-2" title="2">             <span class="dt">data =</span> communities [communities<span class="op">$</span>PctUnemployed <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span> </a>
<a class="sourceLine" id="cb141-3" title="3">                          <span class="op">&amp;</span><span class="st"> </span>communities<span class="op">$</span>PctNotHSGrad <span class="op">&lt;</span><span class="dv">100</span> , ])</a>
<a class="sourceLine" id="cb141-4" title="4"><span class="kw">summary</span>(model3)</a></code></pre></div>
<pre><code>
Call:
lm(formula = PctUnemployed ~ PctNotHSGrad + PctUrban, data = communities[communities$PctUnemployed &lt; 
    100 &amp; communities$PctNotHSGrad &lt; 100, ])

Residuals:
    Min      1Q  Median      3Q     Max 
-38.832  -8.043  -1.301   7.264  55.962 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   8.61368    0.64421  13.371  &lt; 2e-16 ***
PctNotHSGrad  0.68359    0.01528  44.745  &lt; 2e-16 ***
PctUrban      0.17304    0.02269   7.626 3.77e-14 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 12.78 on 1948 degrees of freedom
Multiple R-squared:  0.5204,    Adjusted R-squared:   0.52 
F-statistic:  1057 on 2 and 1948 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>This drops the coefficient slightly for the level of education attainment. What this means is the effect (or the slope of the regression line) on unemployment is reduced. However, the result is still statistically significant as the p-value is less than 0.05.</p>
</div>
<div id="additional-resources" class="section level3">
<h3><span class="header-section-number">7.1.4</span> Additional Resources</h3>
<ul>
<li><a href="http://altaf.shinyapps.io/linear-regression">Linear Regression - Interactive App</a></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="seminar6.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["stats101.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
